---
import { Menu, X, MapPin } from "lucide-astro";
import LanguageSwitcher from "./LanguageSwitcher.astro";
import { useTranslations, getLocalizedPath } from "../i18n/utils";
import type { Language } from "../types";

interface Props {
    lang: Language;
    currentUrl: URL;
}

const { lang, currentUrl } = Astro.props;
const t = useTranslations(lang);

const navItems = [
    { href: "/", label: t("nav", "home") },
    { href: "/places", label: t("nav", "places") },
    { href: "/itineraries", label: t("nav", "itineraries") },
    { href: "/transport", label: t("nav", "transport") },
    { href: "/about", label: t("nav", "about") },
];
---

<header class="bg-white shadow-sm sticky top-0 z-50">
    <nav class="container">
        <div class="flex items-center justify-between h-16">
            <!-- Logo -->
            <a
                href={getLocalizedPath("/", lang)}
                class="flex items-center gap-2 text-primary-600 font-semibold text-lg"
            >
                <MapPin class="w-6 h-6" />
                <span>Pakchong Guide</span>
            </a>

            <!-- Desktop Navigation -->
            <div class="hidden md:flex items-center gap-6">
                {
                    navItems.map((item) => (
                        <a
                            href={getLocalizedPath(item.href, lang)}
                            class="text-gray-600 hover:text-primary-600 transition-colors font-medium"
                        >
                            {item.label}
                        </a>
                    ))
                }
                <LanguageSwitcher lang={lang} currentUrl={currentUrl} />
            </div>

            <!-- Mobile menu button -->
            <button
                type="button"
                class="md:hidden p-2 text-gray-600 hover:text-primary-600"
                id="mobile-menu-button"
                aria-label="Toggle menu"
            >
                <Menu class="w-6 h-6" id="menu-icon" />
                <X class="w-6 h-6 hidden" id="close-icon" />
            </button>
        </div>

        <!-- Mobile Navigation -->
        <div class="hidden md:hidden pb-4" id="mobile-menu">
            <div class="flex flex-col gap-2">
                {
                    navItems.map((item) => (
                        <a
                            href={getLocalizedPath(item.href, lang)}
                            class="text-gray-600 hover:text-primary-600 transition-colors py-2 px-4 rounded-lg hover:bg-gray-50"
                        >
                            {item.label}
                        </a>
                    ))
                }
                <div class="px-4 pt-2 border-t mt-2">
                    <LanguageSwitcher lang={lang} currentUrl={currentUrl} />
                </div>
            </div>
        </div>
    </nav>
</header>

<script>
    const menuButton = document.getElementById("mobile-menu-button");
    const mobileMenu = document.getElementById("mobile-menu");
    const menuIcon = document.getElementById("menu-icon");
    const closeIcon = document.getElementById("close-icon");

    menuButton?.addEventListener("click", () => {
        mobileMenu?.classList.toggle("hidden");
        menuIcon?.classList.toggle("hidden");
        closeIcon?.classList.toggle("hidden");
    });
</script>
